{"version":3,"sources":["../src/index.ts","../src/userAgents.ts"],"sourcesContent":["import pc from \"picocolors\";\nimport { Browser } from \"puppeteer\";\nimport pp from \"puppeteer-extra\";\nimport StealthPlugin from \"puppeteer-extra-plugin-stealth\";\nimport getSystemLocale from \"system-locale\";\nimport { USER_AGENTS } from \"./userAgents\";\n\nclass Simppeteer {\n  private instance: Browser;\n  private userAgent: string;\n\n  constructor() {\n    process.env.MODE === \"services\" && this.init();\n  }\n\n  private async init() {\n    if (!this.instance) {\n      this.changeUserAgent();\n      const locale = await getSystemLocale();\n      pp.use(StealthPlugin());\n      this.instance = await pp.launch({\n        headless: \"new\",\n        args: [\"--no-sandbox\", `--lang=${locale}`],\n      });\n    }\n  }\n\n  async getPage() {\n    if (!this.instance) {\n      await this.init();\n    }\n    const page = await this.instance.newPage();\n    const userAgent = this.userAgent;\n    await page.setUserAgent(userAgent);\n\n    return page;\n  }\n\n  changeUserAgent() {\n    this.userAgent = this.getRandomAgent();\n  }\n\n  getRandomAgent() {\n    return USER_AGENTS[Math.floor(Math.random() * USER_AGENTS.length) - 1];\n  }\n\n  closeInstance() {\n    this.instance.close();\n  }\n\n  async getPageSourceHtml(url: string): Promise<string | undefined> {\n    const page = await this.getPage();\n    let pageSource = \"\";\n\n    try {\n      await page.goto(url, { waitUntil: \"networkidle0\" });\n\n      pageSource = await page.content();\n    } catch (error) {\n      const errorMessage = `Error fetching page ${url}: ${error.message}`;\n      console.log(`${pc.red(\"!!!:\")} ${errorMessage}`);\n    } finally {\n      page.close();\n    }\n\n    return pageSource;\n  }\n}\n\nconst simppeteer = new Simppeteer();\n\nexport default simppeteer;\n","export const USER_AGENTS = [\n  // Chrome user agents\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.61 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36\",\n\n  // Firefox user agents\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:92.0) Gecko/20100101 Firefox/92.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:87.0) Gecko/20100101 Firefox/87.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0\",\n\n  // Safari user agents\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.0 Safari/605.1.15\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2 Safari/605.1.15\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.2 Safari/605.1.15\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.2 Safari/605.1.15\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1.2 Safari/605.1.15\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/10.1.2 Safari/605.1.15\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/9.1.2 Safari/601.5.17\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/8.1.2 Safari/605.1.15\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/7.1.2 Safari/605.1.15\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/6.1.6 Safari/605.1.15\",\n\n  // Edge user agents\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/17.17134\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36 Edge/15.15063\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.97 Safari/537.36 Edge/14.14393\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10136\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36 Edge/12.9600\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1667.0 Safari/537.36 Edge/12.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36 Edge/11.0\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1547.62 Safari/537.36 Edge/10.0\",\n\n  // Opera user agents\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 OPR/64.0.3417.92\",\n  \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 OPR/64.0.3417.92\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.80 Safari/537.36 OPR/58.0.3135.65\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 OPR/50.0.2762.67\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36 OPR/47.0.2631.39\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36 OPR/43.0.2442.991\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 OPR/50.0.2762.67\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36 OPR/37.0.2178.43\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36 OPR/39.0.2256.48\",\n  \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36 OPR/27.0.1689.76\",\n];\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAAe;AAEf,6BAAe;AACf,4CAA0B;AAC1B,2BAA4B;;;ACJrB,IAAM,cAAc;AAAA;AAAA,EAEzB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAGA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;;ADrDA,IAAM,aAAN,MAAiB;AAAA,EACP;AAAA,EACA;AAAA,EAER,cAAc;AACZ,YAAQ,IAAI,SAAS,cAAc,KAAK,KAAK;AAAA,EAC/C;AAAA,EAEA,MAAc,OAAO;AACnB,QAAI,CAAC,KAAK,UAAU;AAClB,WAAK,gBAAgB;AACrB,YAAM,SAAS,UAAM,qBAAAA,SAAgB;AACrC,6BAAAC,QAAG,QAAI,sCAAAC,SAAc,CAAC;AACtB,WAAK,WAAW,MAAM,uBAAAD,QAAG,OAAO;AAAA,QAC9B,UAAU;AAAA,QACV,MAAM,CAAC,gBAAgB,UAAU,MAAM,EAAE;AAAA,MAC3C,CAAC;AAAA,IACH;AAAA,EACF;AAAA,EAEA,MAAM,UAAU;AACd,QAAI,CAAC,KAAK,UAAU;AAClB,YAAM,KAAK,KAAK;AAAA,IAClB;AACA,UAAM,OAAO,MAAM,KAAK,SAAS,QAAQ;AACzC,UAAM,YAAY,KAAK;AACvB,UAAM,KAAK,aAAa,SAAS;AAEjC,WAAO;AAAA,EACT;AAAA,EAEA,kBAAkB;AAChB,SAAK,YAAY,KAAK,eAAe;AAAA,EACvC;AAAA,EAEA,iBAAiB;AACf,WAAO,YAAY,KAAK,MAAM,KAAK,OAAO,IAAI,YAAY,MAAM,IAAI,CAAC;AAAA,EACvE;AAAA,EAEA,gBAAgB;AACd,SAAK,SAAS,MAAM;AAAA,EACtB;AAAA,EAEA,MAAM,kBAAkB,KAA0C;AAChE,UAAM,OAAO,MAAM,KAAK,QAAQ;AAChC,QAAI,aAAa;AAEjB,QAAI;AACF,YAAM,KAAK,KAAK,KAAK,EAAE,WAAW,eAAe,CAAC;AAElD,mBAAa,MAAM,KAAK,QAAQ;AAAA,IAClC,SAAS,OAAO;AACd,YAAM,eAAe,uBAAuB,GAAG,KAAK,MAAM,OAAO;AACjE,cAAQ,IAAI,GAAG,kBAAAE,QAAG,IAAI,MAAM,CAAC,IAAI,YAAY,EAAE;AAAA,IACjD,UAAE;AACA,WAAK,MAAM;AAAA,IACb;AAEA,WAAO;AAAA,EACT;AACF;AAEA,IAAM,aAAa,IAAI,WAAW;AAElC,IAAO,cAAQ;","names":["getSystemLocale","pp","StealthPlugin","pc"]}